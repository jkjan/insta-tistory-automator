FROM openjdk:21-jdk-slim
WORKDIR /app

COPY /build/libs/*.jar app.jar

ARG SPRING_DATASOURCE_URL
ARG SPRING_DATASOURCE_USERNAME
ARG SPRING_DATASOURCE_PASSWORD

ARG INSTA_USER_TOKEN
ARG INSTA_USER_ID
ARG TISTORY_EMAIL
ARG TISTORY_PASSWORD

ENV \
    SPRING_DATASOURCE_URL=$SPRING_DATASOURCE_URL \
    SPRING_DATASOURCE_USERNAME=$SPRING_DATASOURCE_USERNAME \
    SPRING_DATASOURCE_PASSWORD=$SPRING_DATASOURCE_PASSWORD \
    INSTA_USER_TOKEN=$INSTA_USER_TOKEN \
    INSTA_USER_ID=$INSTA_USER_ID \
    TISTORY_EMAIL=$TISTORY_EMAIL \
    TISTORY_PASSWORD=$TISTORY_PASSWORD

EXPOSE 8080

ENTRYPOINT ["java", "-jar", "app.jar"]
